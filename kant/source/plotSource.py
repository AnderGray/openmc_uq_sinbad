from mpl_toolkits.mplot3d import Axes3D
from matplotlib.collections import PolyCollection
from matplotlib import colors as mcolors
import numpy as np
import scipy as sp
import matplotlib.colors as colors


import os
import sys

import h5py
import matplotlib.pyplot as plt
import matplotlib.cm


angles = [-0.8660, -0.5000, -0.1736,  0.0000,  0.5000,  0.8660,  1.0000]

ens = [None]*7
ps = [None]*7

ens[0]=[0.10159,	0.11428,	0.12789,	0.14422,	0.16145,	0.1814,	0.20317,	0.22857,	0.25669,	0.28752,	0.3229,	0.36281,	0.40725,	0.45714,	0.51337,	0.57596,	0.6467,	0.72561,	0.79636,	0.87436,	0.95962,	1.054,	1.1564,	1.2698,	1.3986,	1.5401,	1.697,	1.8694,	2.0589,	2.2675,	2.4526,	2.6521,	2.868,	3.1011,	3.3551,	3.6281,	3.7777,	3.9337,	4.0961,	4.2657,	4.4417,	4.6249,	4.8163,	5.0149,	5.2217,	5.4376,	5.6616,	5.8956,	6.136,	6.3863,	6.6457,	6.9178,	7.1999,	7.4929,	7.7985,	8.1169,	8.448,	8.7917,	9.1509,	9.5237,	9.8112,	10.107,	10.412,	10.725,	11.049,	11.382,	11.587,	11.796,	12.008,	12.224,	12.444,	12.668,	12.896,	13.128,	13.365,	13.605,	13.85,	14.1,	14.354,	14.612,	14.874]
ens[1]=[0.10296,	0.11583,	0.12962,	0.14616,	0.16363,	0.18385,	0.20591,	0.23165,	0.26015,	0.2914,	0.32726,	0.3677,	0.41275,	0.46331,	0.5203,	0.58373,	0.65543,	0.73541,	0.80711,	0.88617,	0.97258,	1.0682,	1.1721,	1.287,	1.4175,	1.5609,	1.7199,	1.8946,	2.0867,	2.2981,	2.4857,	2.6879,	2.9067,	3.1429,	3.4003,	3.677,	3.8287,	3.9868,	4.1514,	4.3233,	4.5016,	4.6873,	4.8813,	5.0826,	5.2922,	5.511,	5.738,	5.9752,	6.2188,	6.4725,	6.7354,	7.0112,	7.2971,	7.594,	7.9038,	8.2264,	8.562,	8.9104,	9.2744,	9.6522,	9.9436,	10.243,	10.552,	10.87,	11.198,	11.536,	11.744,	11.955,	12.17,	12.389,	12.612,	12.839,	13.07,	13.305,	13.545,	13.789,	14.037,	14.29,	14.547,	14.809,	15.075]
ens[2]=[0.10489,	0.118,	0.13205,	0.14891,	0.1667,	0.18731,	0.20978,	0.236,	0.26504,	0.29688,	0.3334,	0.37461,	0.4205,	0.47201,	0.53007,	0.59469,	0.66774,	0.74922,	0.82227,	0.90281,	0.99084,	1.0882,	1.1941,	1.3111,	1.4441,	1.5902,	1.7522,	1.9302,	2.1259,	2.3413,	2.5324,	2.7384,	2.9613,	3.202,	3.4642,	3.7461,	3.9006,	4.0617,	4.2294,	4.4045,	4.5862,	4.7753,	4.973,	5.1781,	5.3916,	5.6145,	5.8458,	6.0874,	6.3356,	6.5941,	6.8619,	7.1429,	7.4341,	7.7366,	8.0523,	8.381,	8.7228,	9.0777,	9.4486,	9.8335,	10.13,	10.436,	10.75,	11.074,	11.409,	11.752,	11.964,	12.18,	12.399,	12.622,	12.849,	13.08,	13.316,	13.555,	13.8,	14.048,	14.301,	14.558,	14.821,	15.087,	15.358]
ens[3]=[0.10624,	0.11952,	0.13375,	0.15082,	0.16885,	0.18972,	0.21248,	0.23904,	0.26845,	0.3007,	0.33769,	0.37943,	0.42591,	0.47808,	0.5369,	0.60235,	0.67634,	0.75886,	0.83285,	0.91443,	1.0036,	1.1023,	1.2094,	1.328,	1.4627,	1.6107,	1.7748,	1.955,	2.1533,	2.3715,	2.565,	2.7736,	2.9994,	3.2432,	3.5088,	3.7943,	3.9508,	4.114,	4.2838,	4.4612,	4.6452,	4.8368,	5.037,	5.2447,	5.461,	5.6867,	5.921,	6.1658,	6.4171,	6.679,	6.9502,	7.2348,	7.5298,	7.8362,	8.1559,	8.4888,	8.8351,	9.1946,	9.5702,	9.9601,	10.261,	10.57,	10.889,	11.217,	11.556,	11.904,	12.118,	12.336,	12.558,	12.784,	13.015,	13.249,	13.487,	13.73,	13.977,	14.229,	14.485,	14.746,	15.011,	15.282,	15.556]
ens[4]=[0.10807,	0.12158,	0.13606,	0.15343,	0.17176,	0.19299,	0.21615,	0.24317,	0.27308,	0.30589,	0.34352,	0.38598,	0.43326,	0.48633,	0.54616,	0.61274,	0.68801,	0.77196,	0.84722,	0.93021,	1.0209,	1.1213,	1.2303,	1.3509,	1.4879,	1.6385,	1.8054,	1.9888,	2.1904,	2.4124,	2.6092,	2.8215,	3.0512,	3.2991,	3.5693,	3.8598,	4.019,	4.185,	4.3577,	4.5381,	4.7253,	4.9203,	5.1239,	5.3352,	5.5552,	5.7848,	6.0232,	6.2721,	6.5278,	6.7942,	7.0701,	7.3596,	7.6597,	7.9714,	8.2966,	8.6353,	8.9875,	9.3532,	9.7353,	10.132,	10.438,	10.752,	11.077,	11.41,	11.755,	12.109,	12.327,	12.549,	12.775,	13.005,	13.239,	13.477,	13.72,	13.967,	14.218,	14.474,	14.735,	15,	15.27,	15.545,	15.824]
ens[5]=[0.11045,	0.12425,	0.13905,	0.1568,	0.17553,	0.19723,	0.2209,	0.24851,	0.27908,	0.31261,	0.35107,	0.39446,	0.44278,	0.49702,	0.55816,	0.6262,	0.70312,	0.78892,	0.86584,	0.95065,	1.0433,	1.1459,	1.2573,	1.3806,	1.5206,	1.6745,	1.8451,	2.0324,	2.2386,	2.4654,	2.6665,	2.8835,	3.1182,	3.3716,	3.6478,	3.9446,	4.1073,	4.2769,	4.4534,	4.6378,	4.8292,	5.0284,	5.2364,	5.4524,	5.6772,	5.912,	6.1555,	6.41,	6.6713,	6.9435,	7.2255,	7.5213,	7.828,	8.1466,	8.4789,	8.825,	9.185,	9.5587,	9.9492,	10.355,	10.667,	10.989,	11.32,	11.661,	12.013,	12.375,	12.598,	12.825,	13.056,	13.29,	13.53,	13.774,	14.021,	14.273,	14.531,	14.792,	15.058,	15.33,	15.606,	15.887,	16.172]
ens[6]=[0.11182,	0.1258,	0.14077,	0.15874,	0.17771,	0.19968,	0.22364,	0.25159,	0.28254,	0.31649,	0.35543,	0.39936,	0.44828,	0.50319,	0.56509,	0.63398,	0.71185,	0.79871,	0.87659,	0.96245,	1.0563,	1.1601,	1.2729,	1.3977,	1.5395,	1.6953,	1.868,	2.0577,	2.2663,	2.496,	2.6996,	2.9193,	3.1569,	3.4135,	3.693,	3.9936,	4.1583,	4.33,	4.5087,	4.6954,	4.8891,	5.0908,	5.3014,	5.5201,	5.7477,	5.9853,	6.2319,	6.4895,	6.7541,	7.0297,	7.3152,	7.6147,	7.9252,	8.2477,	8.5841,	8.9346,	9.299,	9.6774,	10.073,	10.483,	10.8,	11.125,	11.461,	11.806,	12.162,	12.529,	12.754,	12.984,	13.218,	13.455,	13.698,	13.944,	14.195,	14.451,	14.711,	14.976,	15.245,	15.52,	15.799,	16.084,	16.373]
#ens[7]=

ps[0]=[0,	1.64406285556754E-06,	0.000164241421355285,	0.000574911425776097,	0.000657331093142746,	0.00100112492905876,	0.00258089403302382,	0.00299968312067578,	0.00297025709795357,	0.00273467077585222,	0.00366647684884618,	0.00353230217570052,	0.00319263586626764,	0.00409568036956231,	0.00406679005017007,	0.00440282976134584,	0.00414570445535168,	0.0042455423351526,	0.00441134158635786,	0.00413408832852219,	0.00388082365001954,	0.00393790493842965,	0.00365240765610079,	0.00334287562265643,	0.00328258062241636,	0.00282084519093808,	0.00283605004067485,	0.00259332145990744,	0.00221718165585504,	0.00201937414375027,	0.00209902256126179,	0.00265398989287317,	0.00158623303212523,	0.00142513622733597,	0.00127264184149425,	0.00117450514947084,	0.00111042890514769,	0.00107243314004936,	0.000924919886927582,	0.000922604258718401,	0.000918226765912227,	0.000910965237805384,	0.000829140735056666,	0.000899535155103518,	0.000754628028564547,	0.000737103044303684,	0.000772819270243317,	0.00077913641767311,	0.000811505884393859,	0.000765249420718059,	0.000740021086438291,	0.000804915057736605,	0.000709894778299788,	0.000664681079498781,	0.000793568556188699,	0.000782306417334527,	0.000747638661666775,	0.00090448124058644,	0.000927934620385543,	0.000971442625298499,	0.00114802625334664,	0.00125625690058011,	0.0013239816651164,	0.00154209635130052,	0.00171919687331586,	0.00212523140979058,	0.00246099494530419,	0.00290927918295594,	0.00357763007408229,	0.00477659826534541,	0.00688039964570116,	0.0125362929330294,	0.0328925186659393,	0.0991399294168195,	0.178060863313257,	0.206506005763449,	0.15814022591338,	0.109746921808482,	0.0432372500024092,	0.0127599508846882,	0.00263172603537537]
ps[1]=[0,	1.64299862362166E-06,	0.000164290561557064,	0.000575304314333213,	0.000657056111376352,	0.00100112899623565,	0.00258144560006855,	0.00300012018257344,	0.00297025903212465,	0.002734466688519,	0.00366633033756097,	0.00353316114616911,	0.00319200394901197,	0.00409602934942363,	0.00406680038561616,	0.00440328492002094,	0.00414550352256906,	0.00424527916607498,	0.00441156839231702,	0.00413368773852904,	0.00388098347330404,	0.00393938373021583,	0.00364836057081927,	0.00334371210531053,	0.00328361579706705,	0.0028211390269116,	0.00283652380129696,	0.00259384025035055,	0.00221668839601141,	0.00201951119915166,	0.00209902308594579,	0.002653927756758,	0.00158641280732785,	0.00142548176227744,	0.00127285731382384,	0.00117447768303815,	0.00110987284048833,	0.00107249309114932,	0.000924905084183382,	0.000922578273526046,	0.000918650421849852,	0.000910856464348122,	0.000829091751568088,	0.000899479692174836,	0.000754613244510058,	0.000737182539486749,	0.000772916693168293,	0.000779030400865187,	0.000811677728311209,	0.000765215586528064,	0.000740051211380711,	0.000804863279205059,	0.000709928434640525,	0.000664822801414592,	0.000793399958831393,	0.000782564840431709,	0.00074759428449394,	0.000904299690852393,	0.000928015436474725,	0.000971596451292032,	0.00114801531214156,	0.00125792527174189,	0.00132453849691597,	0.00153833808078595,	0.00172119726376849,	0.00212215859068322,	0.00245841913460802,	0.00292065687157653,	0.0035754455552595,	0.00477482260399829,	0.00687957447928686,	0.0125379452793009,	0.0329053384907784,	0.0991983271873899,	0.178215943545398,	0.205867370200267,	0.158337864635709,	0.109912823716455,	0.0433105389127216,	0.0127345990864192,	0.00262715493130507]
ps[2]=[0,	1.64292442085131E-06,	0.000164249535573593,	0.000574870704416055,	0.000657245311334939,	0.00100045669740067,	0.00258145802878046,	0.00299995649514539,	0.00296929308676087,	0.00273372506806926,	0.00366706885096001,	0.00353164638908966,	0.00319186911394632,	0.00409531990547696,	0.00406612944551347,	0.00440260071565686,	0.00414460801178173,	0.00424478262970209,	0.00441065596223851,	0.00413302774085037,	0.0038803612754669,	0.00394083599857747,	0.0036461153272705,	0.00334499969802564,	0.00328179830301475,	0.00282048683413605,	0.00283564143327001,	0.0025930364510126,	0.00221638198358628,	0.0020189015680772,	0.00209894343529057,	0.00265345566550775,	0.00158613755278431,	0.00142488945118939,	0.00127273111383447,	0.00117420728437394,	0.00111004222146288,	0.00107211050451947,	0.000924687221267213,	0.000922557051924252,	0.000918228876232261,	0.000911118716405522,	0.000828708369686203,	0.000899241724430596,	0.000754608223325451,	0.000737081510886421,	0.000772664177754729,	0.000779066221863416,	0.000811454275800241,	0.000764978210476516,	0.000740021476923565,	0.000804666409524149,	0.000709983518073667,	0.000664646848005287,	0.000793050927828568,	0.000782327334658298,	0.000747686647543654,	0.00090427803487514,	0.000927733444263356,	0.000971349326955025,	0.00114924842927502,	0.00125364536522882,	0.00132769571999579,	0.00153790772959373,	0.00171652942170481,	0.00213004610496833,	0.00245686456117793,	0.00290620495906642,	0.00357543072655108,	0.00477646616973471,	0.00688411666533977,	0.0125499834855698,	0.0328068164924548,	0.0993525174766633,	0.177826647360161,	0.206314034345693,	0.158095907868788,	0.11021464560545,	0.0431104187827543,	0.0127763836247837,	0.00262666783782442]
ps[3]=[0,	1.64288418659749E-06,	0.00016427161141109,	0.00057515016563573,	0.000656881434684596,	0.00100077250471575,	0.00258163265848873,	0.00299983735660766,	0.00296986884065337,	0.00273384993862146,	0.0036673548475159,	0.00353191338955879,	0.00319212620926267,	0.00409582601105595,	0.00406551194274913,	0.00440301168256072,	0.00414487860124502,	0.00424550381322086,	0.0044110557070327,	0.00413335274182455,	0.003880119335984,	0.00393751629127694,	0.00365176881685387,	0.0033425213759303,	0.00328234347049315,	0.00282037731158973,	0.00283574508179495,	0.00259453816641162,	0.00221572622525578,	0.00201881210427583,	0.00209962831357642,	0.00265434810628948,	0.00158604584545299,	0.00142493069953097,	0.00127275464868833,	0.00117439747700321,	0.00111001804334976,	0.00107200052920962,	0.000925069958285147,	0.000922385935654513,	0.000918477811136751,	0.000910865710802462,	0.000828950069006286,	0.00089947202094536,	0.000754476481979405,	0.000737359162672318,	0.000772639041739274,	0.000778836245238002,	0.000811813712829198,	0.00076481306267732,	0.000740201117434202,	0.000804758746775945,	0.000709902503360426,	0.000664681411513072,	0.000793263208544724,	0.000782456441976747,	0.00074751775787629,	0.00090428732076999,	0.000927997020987145,	0.000971313779822058,	0.00114714791966924,	0.00125761026568504,	0.00132381327612101,	0.00153882517084455,	0.00171823008595349,	0.00212662884324261,	0.00246529592642935,	0.00291675992318902,	0.0035726470407291,	0.00477399957655428,	0.00685241428520249,	0.0125493704004655,	0.0329526784380464,	0.0989817419350963,	0.178671349519922,	0.205667234169271,	0.158262417184481,	0.109929614855827,	0.0433385793994561,	0.0127025178397725,	0.00263155123801762]
ps[4]=[0,	1.64233935699122E-06,	0.000164177497733145,	0.00057480922899942,	0.000657116231956382,	0.00100051509704146,	0.00258015028619415,	0.00299889350129157,	0.00296987113313001,	0.00273280823640087,	0.00366620434597568,	0.00353104598201255,	0.00319141134567614,	0.00409471205758737,	0.00406477222435558,	0.00440184242518554,	0.0041436755207222,	0.00424392017147098,	0.00441007934488171,	0.00413217427627773,	0.00388006451680239,	0.00393668504792892,	0.00364915606378401,	0.00334284359011264,	0.00328217163361926,	0.00281878613812689,	0.00283541408437548,	0.00259252501440784,	0.00221646176074978,	0.00201801523749667,	0.00209948490859314,	0.00265238490486942,	0.00158558333508287,	0.00142514103448225,	0.00127233843170653,	0.00117381981730275,	0.00110972575149809,	0.00107182525395717,	0.00092498175100864,	0.000922450306802303,	0.000918113321095786,	0.000910186415241403,	0.000828943379854535,	0.000899154864547902,	0.000754386834122327,	0.000737143741500156,	0.000772241166055237,	0.000779012943254671,	0.000811394804780626,	0.000764665654937771,	0.000739948757939998,	0.000804580185439113,	0.000709692258491317,	0.000664475949309807,	0.000793093478118078,	0.000782116981378352,	0.000747477205627731,	0.000904029811726996,	0.000927717324583299,	0.000970900465672971,	0.00114714493454246,	0.00125856021584717,	0.00132148795583583,	0.00154153077278805,	0.0017170868533671,	0.00212613936001732,	0.00246120909394729,	0.00291280849683453,	0.00356901710014803,	0.00477073149232183,	0.00687947248098155,	0.0125474541089134,	0.0328225796607772,	0.0990324942130125,	0.178805104680089,	0.205895404420123,	0.157871867345614,	0.110114503713073,	0.0432577740127884,	0.0127304269948036,	0.00262824672154014]
ps[5]=[0,	1.64363133606795E-06,	0.000164205827926969,	0.000575048754678113,	0.000657407417112512,	0.00100065028027705,	0.00258077824770769,	0.00300019411797716,	0.00297044615348961,	0.00273369985187568,	0.00366698043708404,	0.00353232833473192,	0.00319228988092889,	0.00409565729195544,	0.00406628334988392,	0.0044033476212225,	0.00414517905087269,	0.00424510675000228,	0.00441117455771542,	0.00413352854540179,	0.00388253873845941,	0.00393821347076571,	0.00365010249642573,	0.00334244245304931,	0.00328329427884939,	0.00281970516264566,	0.00283571216441292,	0.00259505777569986,	0.00221530669036058,	0.00201923503635801,	0.0021004046349568,	0.00265278353829068,	0.00158646492866708,	0.00142526586690384,	0.00127236270508281,	0.00117448441132441,	0.00111005862913639,	0.00107244632642172,	0.000925227709541774,	0.000922547423019608,	0.000917976033229095,	0.000910846752925128,	0.000829490120916174,	0.000899196785427625,	0.000754732717701268,	0.000736874784346952,	0.000772915893247756,	0.000778849375381281,	0.000811694373091911,	0.000765042337389817,	0.000740074076118641,	0.000804981840455433,	0.000709884932522223,	0.000664565748608154,	0.000793416592341777,	0.00078243876203321,	0.000747579767695971,	0.000904371969278569,	0.000927923152345337,	0.000970285306121678,	0.00115017689394205,	0.00125468942500935,	0.00132643112661608,	0.0015388385667715,	0.00172037302233937,	0.00212543210137252,	0.00245964258630564,	0.0029122043449635,	0.00356959266680101,	0.00479356847456868,	0.00685688754992137,	0.0125126367826775,	0.0330100075699176,	0.0992292541932828,	0.177829137918824,	0.206442610139521,	0.158355302780514,	0.109663744011648,	0.0432600798706996,	0.0127363613240737,	0.00263028278649976]
ps[6]=[0,	1.64229157927308E-06,	0.000164323071836886,	0.00057494401232293,	0.000657016326112131,	0.00100042709626753,	0.00258071064502995,	0.00299992810864203,	0.00296979040620366,	0.0027328649991303,	0.00366600588667132,	0.00353152859531284,	0.00319165817877456,	0.00409507819803107,	0.00406533213306341,	0.00440214827670389,	0.00414448363916582,	0.00424442703512112,	0.00440997658280609,	0.00413270308600212,	0.00387977589762961,	0.00394008692356615,	0.00364878801390006,	0.00334265340783385,	0.00328124140760572,	0.0028193669998773,	0.00283541556920961,	0.00259358615975243,	0.0022165748078416,	0.0020180824059987,	0.00209993705659607,	0.00265217219644381,	0.00158618719143041,	0.00142475936522078,	0.00127275374278018,	0.00117375962882344,	0.00110996745371509,	0.00107226422784744,	0.000925007804038385,	0.000922307968030668,	0.000918145668301274,	0.000910547227813325,	0.000829259391672605,	0.000898942118746493,	0.000754556234733493,	0.000737089456264757,	0.000772519608013454,	0.000778870950869323,	0.000811363897941309,	0.000764834883160302,	0.000739926075597678,	0.000804748957211104,	0.00070976439588099,	0.000664555247142883,	0.000793348169206227,	0.000782064533654949,	0.000747563495848563,	0.000904063953632562,	0.000927184779169724,	0.000972065706530182,	0.00114587131113997,	0.00125824916646976,	0.00132265436196699,	0.00153960110997156,	0.00172186407094148,	0.0021220789016272,	0.0024675925119988,	0.0029092716847696,	0.00356688706734209,	0.00479077379901016,	0.00685504146621263,	0.0125617481538253,	0.0328812131141895,	0.098875134437398,	0.17861702662974,	0.20581123651118,	0.158502290327443,	0.10979557830891,	0.0433181749174081,	0.0127110651278319,	0.00262555547231493]


fig = plt.figure()
ax = fig.gca(projection='3d')

verts=[]
for i in range(0,7):
    verts.append(list(zip( np.array(ens[i]), np.array(ps[i]))))


poly = PolyCollection(verts)
poly.set_alpha(0.6)
poly.set_linestyle('-')
poly.set_edgecolor('k')
ax.add_collection3d(poly, zs=angles, zdir='y')

maxEn =max(max(ens))

ax.set_ylabel('cosine', fontsize = 12)
ax.set_ylim3d(-1, 1)
ax.set_zlabel('probability/eV',fontsize = 12)
ax.set_zlim3d(0, 0.25)
ax.set_xlabel('energy(Mev)',fontsize = 12)
ax.set_xlim3d(0.1, maxEn + maxEn*0.1)
plt.savefig(f"spectrum.png", dpi=1200)
#plt.show()

